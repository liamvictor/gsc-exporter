<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scenario: Top 100 Pages & Their Keywords</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { padding: 2rem; }
        .step { margin-bottom: 2rem; }
        h2 { border-bottom: 2px solid #dee2e6; padding-bottom: 0.5rem; margin-bottom: 1rem; }
        h3 { margin-top: 1.5rem; }
        code { background-color: #e9ecef; padding: .2em .4em; border-radius: .25rem; font-size: .9em; }
        pre code { display: block; padding: 1rem; }
        .instructions { margin-top: 1rem; }
        footer { margin-top: 3rem; text-align: center; color: #6c757d; }
    </style>
</head>
<body>
    <header class="navbar navbar-expand-lg navbar-light bg-light border-bottom mb-4">
        <div class="container-fluid">
            <a class="navbar-brand" href="index.html">GSC Exporter Scripts</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="common-scenarios.html">Common Scenarios</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="script-flags.html">Script Flags</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://github.com/liamdelahunty/gsc-exporter" target="_blank">GitHub</a>
                    </li>
                </ul>
            </div>
        </div>
    </header>
    <div class="container">
        <h1 class="mb-4">How to Find Your Top 100 Pages and Their Keywords</h1>
        <p class="lead">This guide explains how to identify your top 100 performing pages and the specific keywords that drive traffic to them, using the CSV output and a pivot table.</p>

        <div class="step">
            <h2>Step 1: Generate the Data</h2>
            <p>The first step is to run the <code>gsc-pages-queries.py</code> script for your desired site and date range. This will generate a CSV file containing all the raw data needed for this analysis.</p>
            <h6>Command:</h6>
            <pre><code>py gsc-pages-queries.py https://www.hr-inform.co.uk --last-month</code></pre>
            <div class="instructions">
                <strong>Action:</strong>
                <p>After running this command, locate the generated CSV file in the output directory. It will be named something like <code>output/hr-inform.co.uk/gsc-pages-queries-hr-inform-co-uk-....csv</code>.</p>
            </div>
        </div>

        <div class="step">
            <h2>Step 2: Create a Pivot Table</h2>
            <p>The most powerful way to analyze this data is with a pivot table in a spreadsheet program like Microsoft Excel or Google Sheets. This will allow you to aggregate the data and find the top pages easily.</p>
            <div class="instructions">
                <strong>Action:</strong>
                <ol>
                    <li>Open the CSV file in your spreadsheet program.</li>
                    <li>Create a new pivot table using the data from the CSV.</li>
                    <li>Set up your pivot table fields as follows:
                        <ul>
                            <li><strong>Rows:</strong>
                                <ol>
                                    <li>Add `page` as the first row field.</li>
                                    <li>Add `query` as the second row field, nested under `page`.</li>
                                </ol>
                            </li>
                            <li><strong>Values:</strong>
                                <ul>
                                    <li>Add `clicks` as a value (summarized by Sum).</li>
                                    <li>Add `impressions` as a value (summarized by Sum).</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>Your pivot table will now show every page, and if you expand a page, you will see all the queries that drove traffic to it, along with the total clicks and impressions.</li>
                </ol>
            </div>
        </div>

        <div class="step">
            <h2>Step 3: Filter for the Top 100 Pages</h2>
            <p>Now, use the pivot table's filtering capabilities to narrow the results down to only the top 100 pages based on total clicks.</p>
            <div class="instructions">
                <strong>Action:</strong>
                <ol>
                    <li>In your pivot table, find the filter option for the `page` field.</li>
                    <li>Choose a "Value Filter" or "Filter by value".</li>
                    <li>Select the option for "Top 10..." (this is standard in most spreadsheet programs).</li>
                    <li>Configure the filter to show the <strong>Top 100</strong> items by <strong>Sum of clicks</strong>.</li>
                </ol>
                <p><strong>Result:</strong> The pivot table will now display only the 100 pages that received the most clicks in the last month. You can expand each page row to see the exact queries that contributed to that page's performance.</p>
            </div>
        </div>

    </div>
    <footer>
        <p><a href="index.html">Back to Resources</a> | <a href="https://github.com/liamdelahunty/gsc-exporter" target="_blank">gsc-exporter</a></p>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
